---
- name: Create directory structure
  ansible.builtin.file:
    path: "{{ login_center_path }}"
    state: directory
    owner: root
    group: root
    mode: "0755"

- name: Create env file
  ansible.builtin.template:
    src: env_file.tpl
    dest: "{{ login_center_path }}/.env"
    owner: root
    group: root
    mode: "0640"

- name: test
  ansible.builtin.debug:
    msg: "{{ distr[version].url }}"

- name: Download distrib login center's
  ansible.builtin.get_url:
    url: "{{ distr[version].url }}"
    dest: "{{ login_center_path }}/../"
    mode: "0750"
  async: 1000
  poll: 0
  register: get_distr_status

- name: test
  ansible.builtin.debug:
    msg: "{{ get_distr_status }}"

- name: Check status get distrib
  ansible.builtin.async_status:
    jid: "{{ get_distr_status.ansible_job_id }}"
  register: get_distr_status_result
  until: get_distr_status_result.finished
  delay: 5
  retries: 100
